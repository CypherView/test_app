{
  "version": 3,
  "sources": ["src/app/features/app-store/models/api/app-store-api.mappers.ts", "src/app/features/app-store/services/app-store.service.ts"],
  "sourcesContent": ["import {\n  AppDefinition,\n  AppReview,\n  IntegrationPoint,\n} from '../app-store.models';\nimport {\n  AppDefinitionApiResponse,\n  AppReviewApiResponse,\n  IntegrationPointApiResponse,\n} from './app-store-api.models';\n\n/**\n * Maps API status string to frontend status\n */\nfunction mapStatusFromApi(\n  status: AppDefinitionApiResponse['status'],\n): AppDefinition['status'] {\n  return status;\n}\n\n/**\n * Maps frontend screenId string to API screenId string\n */\nexport function mapScreenIdToApi(\n  screenId: IntegrationPoint['screenId'],\n): IntegrationPointApiResponse['screenId'] {\n  return screenId;\n}\n\n/**\n * Maps IntegrationPoint API response to frontend model\n */\nfunction mapIntegrationPointFromApi(\n  apiPoint: IntegrationPointApiResponse,\n): IntegrationPoint {\n  return {\n    screenId: apiPoint.screenId,\n    requiredPermissions: apiPoint.requiredPermissions,\n    baseUrl: apiPoint.baseUrl,\n  };\n}\n\n/**\n * Maps AppDefinition API response to frontend model\n */\nexport function mapAppDefinitionFromApi(\n  apiResponse: AppDefinitionApiResponse,\n): AppDefinition {\n  return {\n    id: apiResponse.id,\n    developerId: apiResponse.developerId,\n    developerName: apiResponse.developerName,\n    name: apiResponse.name,\n    description: apiResponse.description,\n    shortDescription: apiResponse.shortDescription,\n    iconUrl: apiResponse.iconUrl,\n    status: mapStatusFromApi(apiResponse.status),\n    state: apiResponse.state,\n    integrationPoints: apiResponse.integrationPoints.map(\n      mapIntegrationPointFromApi,\n    ),\n    healthCheckUrl: apiResponse.healthCheckUrl,\n    categories: apiResponse.categories,\n    tags: apiResponse.tags,\n    averageRating: apiResponse.averageRating,\n    reviewCount: apiResponse.reviewCount,\n    installCount: apiResponse.installCount,\n    isInstalled: apiResponse.isInstalled,\n    isEnabled: apiResponse.isEnabled,\n    updatedDate: apiResponse.updatedDate,\n    createdDate: apiResponse.createdDate,\n  };\n}\n\n/**\n * Maps AppReview API response to frontend model\n */\nexport function mapAppReviewFromApi(\n  apiResponse: AppReviewApiResponse,\n): AppReview {\n  return {\n    id: apiResponse.id,\n    appId: apiResponse.appId,\n    userId: apiResponse.userId,\n    userName: apiResponse.userName,\n    organizationName: apiResponse.organizationName,\n    rating: apiResponse.rating,\n    title: apiResponse.title,\n    comment: apiResponse.comment,\n    developerResponse: apiResponse.developerResponse,\n    isVerifiedPurchase: apiResponse.isVerifiedPurchase,\n    helpfulCount: apiResponse.helpfulCount,\n    createdDate: apiResponse.createdDate,\n  };\n}\n", "import { Injectable, inject } from '@angular/core';\nimport { HttpClient, HttpParams } from '@angular/common/http';\nimport { Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { AppDefinition } from '../models/app-store.models';\nimport {\n  AppDefinitionApiResponse,\n  AppDefinitionListApiResponse,\n  AppListQueryParams,\n  CreateAppDefinitionRequest,\n  UpdateAppDefinitionRequest,\n  AppSubmissionReviewRequest,\n} from '../models/api/app-store-api.models';\nimport { mapAppDefinitionFromApi } from '../models/api/app-store-api.mappers';\nimport { ApiUrlService } from '../../../core/services/api-url.service';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class AppStoreService {\n  private readonly http = inject(HttpClient);\n  private readonly apiUrlService = inject(ApiUrlService);\n  private readonly baseUrl: string;\n\n  constructor() {\n    this.baseUrl = `${this.apiUrlService.getCurrentApiUrl()}/appstore`;\n  }\n\n  /**\n   * Get all app definitions with optional filtering\n   * @param params Query parameters for filtering and pagination\n   */\n  getApps(params: AppListQueryParams): Observable<AppDefinition[]> {\n    const httpParams = this.buildGetAppsQueryParams(params);\n\n    return this.http\n      .get<AppDefinitionListApiResponse>(`${this.baseUrl}/apps`, {\n        params: httpParams,\n      })\n      .pipe(map((response) => response.items.map(mapAppDefinitionFromApi)));\n  }\n\n  /**\n   * Get app definitions of a specific developer with optional filtering\n   * @param params Query parameters for filtering and pagination\n   */\n  getMyApps(params: AppListQueryParams): Observable<AppDefinition[]> {\n    const httpParams = this.buildGetAppsQueryParams(params);\n\n    return this.http\n      .get<AppDefinitionListApiResponse>(`${this.baseUrl}/me/apps`, {\n        params: httpParams,\n      })\n      .pipe(map((response) => response.items.map(mapAppDefinitionFromApi)));\n  }\n\n  /**\n   * Get app definitions of a specific developer with optional filtering\n   * @param params Query parameters for filtering and pagination\n   */\n  getAppsByDeveloperId(\n    developerId: string,\n    params: AppListQueryParams,\n  ): Observable<AppDefinition[]> {\n    const httpParams = this.buildGetAppsQueryParams(params);\n\n    return this.http\n      .get<AppDefinitionListApiResponse>(\n        `${this.baseUrl}/developers/${developerId}/apps`,\n        {\n          params: httpParams,\n        },\n      )\n      .pipe(map((response) => response.items.map(mapAppDefinitionFromApi)));\n  }\n\n  private buildGetAppsQueryParams(params: AppListQueryParams): HttpParams {\n    let httpParams = new HttpParams().set('owner', params.owner);\n\n    if (params.offset !== undefined) {\n      httpParams = httpParams.set('offset', params.offset.toString());\n    }\n    if (params.limit !== undefined) {\n      httpParams = httpParams.set('limit', params.limit.toString());\n    }\n    if (params.sort !== undefined) {\n      httpParams = httpParams.set('sort', params.sort);\n    }\n    if (params.filter !== undefined) {\n      httpParams = httpParams.set('filter', params.filter);\n    }\n    if (params.status !== undefined) {\n      httpParams = httpParams.set('status', params.status);\n    }\n\n    return httpParams;\n  }\n\n  /**\n   * Get app definition by ID\n   * @param id App ID\n   * @param developerId Optional developer ID filter\n   */\n  getAppById(id: string, owner: string): Observable<AppDefinition | null> {\n    const httpParams = new HttpParams().set('owner', owner);\n\n    return this.http\n      .get<AppDefinitionApiResponse>(`${this.baseUrl}/apps/${id}`, {\n        params: httpParams,\n      })\n      .pipe(map(mapAppDefinitionFromApi));\n  }\n\n  /**\n   * Create a new app definition\n   * @param app App definition data\n   */\n  createApp(app: Partial<AppDefinition>): Observable<AppDefinition> {\n    const request: CreateAppDefinitionRequest = {\n      developerName: app.developerName ?? '',\n      name: app.name ?? '',\n      description: app.description ?? '',\n      shortDescription: app.shortDescription ?? '',\n      iconUrl: app.iconUrl ?? '',\n      integrationPoints:\n        app.integrationPoints?.map((point) => ({\n          screenId: point.screenId,\n          requiredPermissions: point.requiredPermissions,\n          baseUrl: point.baseUrl,\n        })) ?? [],\n      categories: app.categories ?? [],\n      tags: app.tags ?? [],\n      healthCheckUrl: app.healthCheckUrl,\n    };\n\n    return this.http\n      .post<AppDefinitionApiResponse>(`${this.baseUrl}/apps`, request)\n      .pipe(map(mapAppDefinitionFromApi));\n  }\n\n  /**\n   * Update an existing app definition\n   * @param id App ID\n   * @param changes Partial app definition with changes\n   */\n  updateApp(\n    id: string,\n    changes: Partial<AppDefinition>,\n  ): Observable<AppDefinition> {\n    const request: UpdateAppDefinitionRequest = {\n      name: changes.name,\n      description: changes.description,\n      shortDescription: changes.shortDescription,\n      iconUrl: changes.iconUrl,\n      integrationPoints: changes.integrationPoints?.map((point) => ({\n        screenId: point.screenId,\n        requiredPermissions: point.requiredPermissions,\n        baseUrl: point.baseUrl,\n      })),\n      healthCheckUrl: changes.healthCheckUrl,\n      categories: changes.categories,\n      tags: changes.tags,\n      status: changes.status,\n      state: changes.state,\n    };\n\n    return this.http\n      .put<AppDefinitionApiResponse>(`${this.baseUrl}/apps/${id}`, request)\n      .pipe(map(mapAppDefinitionFromApi));\n  }\n\n  /**\n   * Submit an app for review (changes status to PENDING_REVIEW)\n   * @param id App ID\n   */\n  submitForReview(id: string): Observable<AppDefinition> {\n    return this.updateApp(id, { status: 'pendingReview' });\n  }\n\n  /**\n   * Approve an app (admin only - changes status to APPROVED)\n   * @param id App ID\n   * @note Status updates are handled server-side; this updates the app state to active\n   */\n  approveApp(id: string): Observable<AppDefinition> {\n    const request: UpdateAppDefinitionRequest = {\n      status: 'approved',\n    };\n\n    return this.http\n      .put<AppDefinitionApiResponse>(`${this.baseUrl}/apps/${id}`, request)\n      .pipe(map(mapAppDefinitionFromApi));\n  }\n\n  /**\n   * Reject an app (admin only - changes status to REJECTED)\n   * @param id App ID\n   * @note Status updates are handled server-side; this updates the app state to inactive\n   */\n  rejectApp(id: string): Observable<AppDefinition> {\n    const request: UpdateAppDefinitionRequest = {\n      status: 'rejected',\n    };\n\n    return this.http\n      .put<AppDefinitionApiResponse>(`${this.baseUrl}/apps/${id}`, request)\n      .pipe(map(mapAppDefinitionFromApi));\n  }\n\n  /**\n   * Suspend an app (admin only - changes status to SUSPENDED)\n   * @param id App ID\n   * @note Status updates are handled server-side; this updates the app state to suspended\n   */\n  suspendApp(id: string): Observable<AppDefinition> {\n    const request: UpdateAppDefinitionRequest = {\n      status: 'suspended',\n    };\n\n    return this.http\n      .put<AppDefinitionApiResponse>(`${this.baseUrl}/apps/${id}`, request)\n      .pipe(map(mapAppDefinitionFromApi));\n  }\n\n  /**\n   * Review an app submission (approve, reject, suspend, etc.)\n   * @param id App ID\n   * @param reviewData Review data including status, comments, and internal notes\n   */\n  reviewApp(\n    id: string,\n    reviewData: AppSubmissionReviewRequest,\n  ): Observable<AppDefinition> {\n    return this.http\n      .post<AppDefinitionApiResponse>(\n        `${this.baseUrl}/apps/${id}/submission-review`,\n        reviewData,\n      )\n      .pipe(map(mapAppDefinitionFromApi));\n  }\n}\n"],
  "mappings": "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",
  "names": []
}
